"use strict";jQuery(document).ready(function(e){if(e(".block-editor__container").length){window.tagBox&&window.tagBox.init();k()}else{k()}var p=e(".dfn-post-count").val();var t=-40;var r=0;var j=0;var f=0;var b=1;var d=e(".dfn-existing-definitions").val().split(",");e(document).on("keyup",'input[name="newtag[definitions_title]"]',h);function h(){var B=e('input[name="newtag[definitions_title]"]').val();if(B.length==0){var x='<div class="dfn-icon-bullet-invisible"></div><span class="dfn-comment">'+m("add-term")+"</span>";e(".dfn-definition-add-notice").html(x);return}var y=B.split(",");var A=l(y);if(A.length>0){A=A.join(", ");e('input[name="dfn-definition-add"]').prop("disabled",true);if(A.indexOf(",")>=0){var z=m("already-in-use-plural").replace("{definitions}",A)}else{var z=m("already-in-use-single").replace("{definitions}",A)}var x='<div class="dfn-icon-bullet-red"></div><span class="dfn-comment">'+z+"</span>";e(".dfn-definition-add-notice").html(x)}else{e('input[name="dfn-definition-add"]').prop("disabled",false);if(B.indexOf(",")>=0){var z=m("not-in-use-plural").replace("{definitions}",B)}else{var z=m("not-in-use-single").replace("{definitions}",B)}var x='<div class="dfn-icon-bullet-green"></div><span class="dfn-comment">'+z+"</span>";e(".dfn-definition-add-notice").html(x)}}function l(y){var z=[];for(let i=0;i<y.length;i++){var x=e.trim(y[i]);if(e.inArray(x,d)!==-1){z.push(x)}}return z}c();v();e(document).on("click",'input[name="dfn-definition-add"]',v);e(document).on("click",'span[class="remove-tag-icon"]',v);e(document).on("click",'input[name="dfn-definition-add"]',g);e(document).on("click",'span[class="remove-tag-icon"]',w);e(document).on("click",'input[name="dfn-definition-add"]',h);e(document).on("click",'span[class="remove-tag-icon"]',h);function k(){if(u().length==0){e('input[class="dfn-enable"]').prop("disabled",true)}else{e('input[class="dfn-enable"]').prop("disabled",false)}}function m(x){if(wpdef.strings.hasOwnProperty(x)){return wpdef.strings[x]}return""}function g(){var x=u().pop();d.push(x);k()}function w(){var x=e(this).next().html().split(" ").pop();d=d.filter(function(y){return y!=x});k()}function v(){var x=u();e.ajax({type:"GET",url:wpdef.url,dataType:"json",data:({action:"wpdef_scan_definition_count",definitions:x,post_id:e("#post_ID").val()}),success:function(y){if(y.success){j=y.count;a()}}})}function a(){if(r==j){return}t=-40;f=(j-r)/80;s()}function o(y){return 0.04*y*y+y+1}function s(){if(t!=40){t++;r+=f;if(b!=n(Math.round(r),p)){c();setTimeout(s,o(t))}else{e(".dfn-definition-count").html(Math.round(r));setTimeout(s,o(t))}}else{if(b!=n(Math.round(r),p)){r=j;c()}else{e(".dfn-definition-count").val(j);r=j}}}function c(){var x=q(r);e(".dfn-performance-notice").html(x)}function q(x){x=Math.round(x);var y=n(x,p);var B="";var C="<span class='dfn-definition-count-notice'>"+m("terms-in-posts")+"<span>";C=C.replace("{terms_count}","<span class='dfn-definition-count'>"+x+"</span>");C=C.replace("{posts_count}",""+p);var A="";if(y==3){B="<div class='dfn-icon-bullet-red'></div>";A="<span class='dfn-comment'>"+m("too-many-terms")+"<a>"+m("read-more")+"</a><span>"}if(y==2){B="<div class='dfn-icon-bullet-orange'></div>";A="<span class='dfn-comment'>"+m("too-many-terms")+"<a>"+m("read-more")+"</a><span>"}if(y==1){B="<div class='dfn-icon-bullet-green'></div>";A="<span class='dfn-comment'>"+m("positive-ratio-terms")+"<a>"+m("read-more")+"</a><span>"}var z="";z+="<div class='dfn-field'>";z+=B;z+=C;z+="</div>";z+=A;z+="<input type='hidden' class='dfn-definition-ids' value='"+x+"'>";z+="<br><br>";return z}function n(x,y){if(x/y>0.5){return 3}if(x/y>0.25){return 2}return 1}function u(){var x=[];e(".dfn-post-definition-list li").each(function(){x.push(e(this).html().split("&nbsp;").pop())});return x}});